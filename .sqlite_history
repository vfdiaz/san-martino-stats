select * from athletes
;
select * from competitions
;
select * from results;
quit;
quit;
quit
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete group by a.fullname order by min(r.time);
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competition c on c.id = r.competition group by a.fullname order by min(r.time);
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id 
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete 
;
select a.fullname as fullname as time from athletes a inner join results r on a.id = r.athlete 
;
select a.fullname as fullname as time from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname r.time as time from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname, r.time as time from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname, r.time as time, rank() over (order by r.time) mejor from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname, r.time as time, rank( ) over (order by r.time) mejor from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname, r.time as time, rank( ) over ( order by r.time) mejor from athletes a inner join results r on a.id = r.athlete ;
select a.fullname as fullname, r.time as time, rank( ) over ( order by r.time) mejor from athletes a inner join results r on a.id = r.athlete ;
SELECT
choices.db Val,
choices.db RANK () OVER ( 
choices.db choices.db ORDER BY Val 
choices.db ) ValRank
FROM
choices.db RankDemo;
choices.db ) ValRank
;
select val, rank () over (order by val) valrank from rankdemo
;
select * from athlete
;
select * from athletes;
select rank () over ( order by fullname ) num from athletes;
select rank () over ( partition by fullname order by fullname ) num from athletes;
select a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select row_number() a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select row_number(), a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select rank(), a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select rowid, a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select  a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select r.competition,  a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select c.year,  a.fullname as fullname, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
create table global_ranking (position integer primary key autoincrement, athlete_id integer, athlete_fullname text, competition_id integer, competition_year integer);
select * from global_ranking;
insert into global_ranking( athlete_id, athlete_fullname, competition_id, competition_year) 
;
drop table global_ranking;
create table global_ranking (position integer primary key autoincrement, athlete_id integer, athlete_fullname text, competition_id integer, competition_year integer, time as integer);
create table global_ranking (position integer primary key autoincrement, athlete_id integer, athlete_fullname text, competition_id integer, competition_year integer, time integer);
insert into global_ranking( athlete_id, athlete_fullname, competition_id, competition_year) select a.id,  a.fullname, c.id, c.year, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
insert into global_ranking( athlete_id, athlete_fullname, competition_id, competition_year, time) select a.id,  a.fullname, c.id, c.year, min(r.time) as time from athletes a inner join results r on a.id = r.athlete inner join competitions c on c.id = r.competition group by a.fullname order by min(r.time);
select * from globak_ranking;
select * from global_ranking;
select * from competitions;
select * from competitions;
select competition, count(*)  from results group by competition;
select * from results where competition = 2;
select competition, count(*)  from results group by competition;
select competition, count(*)  from results group by competition;
select * from competitions;
select * from results where competition = 4;
ls
;
select * from results;
select * from results;
select * from results;
select athlete, count(*) from results group by athlete order by 2 desc limit 10;
select athlete, competition, count(*) from results group by athlete, competition order by 2 desc limit 10;
